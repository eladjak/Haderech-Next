# דאשבורד ניהול למנהל - תיעוד

מסמך זה מתאר את פונקציונליות דאשבורד הניהול למנהל האפליקציה "הדרך", המיועד לאפשר שליטה מלאה ופיקוח על כל היבטי המערכת.

## סקירה כללית

דאשבורד הניהול למנהל מרכז את כל יכולות הניהול והבקרה של האפליקציה במקום אחד. הוא מאפשר למנהלי המערכת לעקוב אחרי פעילות המשתמשים, לנהל תוכן, להפיק דוחות, ולבצע פעולות תחזוקה שונות.

## גישה ואבטחה

- גישה מוגבלת למשתמשים עם הרשאות מנהל בלבד
- אימות דו-שלבי (2FA) חובה לכניסה לממשק הניהול
- רישום מלא (Audit Log) של כל פעולה המבוצעת במערכת הניהול
- הרשאות מדורגות למנהלים שונים (מנהל ראשי, מנהל תוכן, מנהל משתמשים וכו')

## מרכיבים עיקריים

### 1. לוח מחוונים ראשי (Dashboard)

תצוגה כללית של מצב המערכת:

- **מדדים עיקריים** - מספר משתמשים פעילים, משתמשים חדשים, קורסים פעילים, ועוד
- **גרפים פעילות** - פעילות לאורך זמן, שימוש במודולים שונים של המערכת
- **התראות מערכת** - בעיות הדורשות טיפול, שגיאות, ותקלות פוטנציאליות

### 2. ניהול משתמשים

ניהול מלא של משתמשי המערכת:

- **רשימת משתמשים** - תצוגה ועריכה של כל המשתמשים במערכת
- **ניהול הרשאות** - הקצאת תפקידים והרשאות למשתמשים
- **פעולות משתמש** - חסימה/שחרור, איפוס סיסמה, שליחת הודעות
- **נתוני פעילות** - הצגת נתוני שימוש והתקדמות מפורטים עבור כל משתמש

### 3. ניהול קורסים ותוכן

ניהול התוכן הלימודי באפליקציה:

- **יצירה ועריכת קורסים** - ממשק מתקדם ליצירה ועריכה של קורסים ושיעורים
- **ארגון תוכן** - סידור הקורסים בקטגוריות ומסלולי למידה
- **ניהול מדיה** - העלאה, עריכה וארגון של קבצי מדיה (וידאו, תמונות, מסמכים)
- **גרסאות ופרסום** - ניהול גרסאות תוכן ותזמון פרסום

### 4. ניהול הפורום והקהילה

פיקוח וניהול התוכן הקהילתי:

- **ניהול דיונים** - יצירה, עריכה, ומחיקה של דיונים ותגובות
- **מודרציה** - סינון תוכן פוגעני, דיווחים וטיפול בתלונות
- **ניהול קטגוריות ותגיות** - ארגון נושאי הדיון בפורום
- **משתמשים מובילים** - זיהוי וקידום משתמשים פעילים ותורמים לקהילה

### 5. ניהול הסימולטור

שליטה במערכת הסימולציה והתרגול:

- **יצירת תרחישים** - הוספה ועריכה של תרחישי תרגול
- **הגדרת פרמטרים** - התאמת פרמטרים לסימולציה, כגון רמות קושי
- **משוב וניתוח** - הגדרת מדדי הערכה ומשוב למשתמשים
- **מעקב ביצועים** - ניתוח סטטיסטיקות שימוש וביצועי משתמשים

### 6. ניהול האינטגרציה עם AI

ניהול הבוט החכם וטכנולוגיות AI:

- **הגדרת התנהגות הבוט** - עריכת התגובות והיכולות של הבוט החכם
- **ניהול תזכורות** - הגדרת מדיניות תזכורות והתראות אוטומטיות
- **ניטור שיחות** - בקרת איכות על תשובות הבוט וזיהוי בעיות
- **התאמה אישית** - הגדרת כללים להתאמה אישית של חוויית המשתמש

### 7. דוחות וניתוחים

מערכת דוחות מתקדמת:

- **דוחות מובנים** - מגוון דוחות מוכנים מראש לניתוח נתונים
- **בניית דוחות מותאמים** - כלי ליצירת דוחות מותאמים אישית
- **ייצוא נתונים** - ייצוא דוחות בפורמטים שונים (CSV, Excel, PDF)
- **ניתוח מגמות** - זיהוי מגמות ותובנות מנתוני המערכת

### 8. הגדרות מערכת

שליטה בתצורת המערכת:

- **הגדרות כלליות** - שם האתר, לוגו, צבעים, ופרטי קשר
- **הגדרות תצוגה** - התאמת ממשק המשתמש ואפשרויות תצוגה
- **ניהול הודעות מערכת** - יצירה ועריכה של הודעות מערכת
- **הגדרות אבטחה** - מדיניות סיסמאות, אימות דו-שלבי, וחסימת IP

## ארכיטקטורה טכנית

### רכיבי לקוח (Client-Side)

- **AdminDashboard** - הרכיב הראשי המארגן את כל חלקי הממשק
- **AdminSidebar** - תפריט צד עם גישה לכל חלקי מערכת הניהול
- **DataGrid** - טבלאות נתונים עם יכולות מיון, סינון, ועריכה
- **AdminCharts** - רכיבי ויזואליזציה לנתונים סטטיסטיים
- **AdminForms** - טפסים לעריכת והוספת מידע במערכת

### רכיבי שרת (Server-Side)

- **AdminService** - שירות מרכזי לניהול בקשות מדאשבורד המנהל
- **ReportingService** - שירות להפקת דוחות וניתוח נתונים
- **AuditService** - שירות לתיעוד ומעקב אחר פעולות ניהוליות
- **AdminAuthService** - שירות אימות ואבטחה עבור מנהלי המערכת

### מודל נתונים

טבלאות נוספות בבסיס הנתונים הקשורות לניהול:

- `admin_users` - מנהלי המערכת והרשאותיהם
- `admin_roles` - תפקידים והרשאות במערכת הניהול
- `audit_logs` - תיעוד פעולות ניהוליות
- `system_settings` - הגדרות מערכת גלובליות
- `reports` - תבניות דוחות ותצורה

## תזרים עבודה

### ניהול משתמשים

1. המנהל נכנס לסעיף "ניהול משתמשים"
2. המערכת מציגה טבלה עם כל המשתמשים הרשומים
3. המנהל יכול לסנן ולמיין את הרשימה לפי פרמטרים שונים
4. בחירת משתמש מציגה מסך עם פרטים מלאים ואפשרויות פעולה
5. המנהל יכול לערוך פרטים, לשנות הרשאות, או לבצע פעולות אחרות

### פרסום קורס חדש

1. המנהל נכנס לסעיף "ניהול קורסים" ובוחר "הוסף קורס חדש"
2. המנהל ממלא את פרטי הקורס וקובע את המבנה שלו
3. המנהל מוסיף שיעורים ותוכן לקורס
4. המנהל יכול לצפות בתצוגה מקדימה של הקורס לפני פרסום
5. לאחר אישור, המנהל מפרסם את הקורס ומגדיר את תנאי הגישה אליו

### הפקת דוח פעילות

1. המנהל נכנס לסעיף "דוחות וניתוחים"
2. המנהל בוחר בסוג הדוח הרצוי או יוצר דוח מותאם אישית
3. המנהל מגדיר פרמטרים לדוח (תקופת זמן, משתמשים, קורסים, וכו')
4. המערכת מעבדת את הנתונים ומציגה את הדוח
5. המנהל יכול לייצא את הדוח או לשמור אותו לשימוש עתידי

## תכונות מתקדמות

### 1. ניתוח חכם של התנהגות משתמשים

מערכת המנתחת את התנהגות המשתמשים ומספקת תובנות:

- זיהוי דפוסים ומגמות בהתנהגות משתמשים
- חיזוי נשירת משתמשים וזיהוי משתמשים בסיכון
- המלצות לשיפור מעורבות ושימור משתמשים

### 2. ניהול A/B Testing

כלים לביצוע ניסויים והשוואת גרסאות:

- יצירת מבחני A/B לתכונות ותוכן
- הקצאת משתמשים לקבוצות ניסוי שונות
- מדידת תוצאות והשוואת ביצועים
- ניתוח סטטיסטי של תוצאות

### 3. בינה עסקית (BI)

כלים מתקדמים לניתוח עסקי:

- מחוון KPI מותאם למנהל העסק
- תחזיות וניתוח מגמות
- התראות על חריגות ואנומליות
- אינטגרציה עם כלי BI חיצוניים

## סטטוס פיתוח

- [x] דאשבורד בסיסי עם נתונים עיקריים
- [x] ניהול משתמשים בסיסי
- [ ] ניהול קורסים מתקדם עם עורך תוכן
- [ ] מערכת דוחות מתקדמת
- [ ] ניתוח חכם של התנהגות משתמשים
- [ ] ניהול A/B Testing
- [ ] ממשק API למערכות חיצוניות

## התקנה ושימוש למפתחים

### קבצים רלוונטיים

- `src/components/admin/` - רכיבי ממשק הניהול
- `src/app/admin/` - דפי ממשק הניהול
- `src/lib/services/admin/` - שירותי צד שרת לממשק הניהול
- `src/app/api/admin/` - נקודות קצה API לממשק הניהול

### הוספת תכונה חדשה לממשק הניהול

1. הגדר את הטיפוסים הדרושים ב-`src/types/admin.ts`
2. הוסף לוגיקת שרת ב-`src/lib/services/admin/`
3. צור/עדכן את ה-API endpoint ב-`src/app/api/admin/`
4. הוסף את הרכיב החדש ב-`src/components/admin/`
5. שלב את הרכיב בדף הניהול המתאים ב-`src/app/admin/`

## שאלות נפוצות למפתחים

### כיצד להוסיף סוג דוח חדש?

1. הגדר את מבנה הדוח ב-`src/types/admin/reports.ts`
2. הוסף את לוגיקת הפקת הדוח ב-`src/lib/services/admin/reporting.ts`
3. הוסף רכיב תצוגה לדוח ב-`src/components/admin/reports/`

### כיצד להרחיב את הרשאות המנהלים?

1. הוסף את התפקיד החדש ב-`src/types/admin/roles.ts`
2. הגדר את ההרשאות המתאימות ב-`src/lib/services/admin/auth.ts`
3. עדכן את מסך ניהול ההרשאות ב-`src/components/admin/users/RolesManager.tsx`

## נספחים

### מודל נתונים מפורט

```sql
-- טבלת תפקידים והרשאות
CREATE TABLE admin_roles (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name TEXT NOT NULL,
  permissions JSONB NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

-- טבלת מנהלים
CREATE TABLE admin_users (
  id UUID REFERENCES auth.users NOT NULL PRIMARY KEY,
  role_id UUID REFERENCES admin_roles NOT NULL,
  is_active BOOLEAN DEFAULT true,
  last_login TIMESTAMP WITH TIME ZONE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

-- טבלת רישום פעולות
CREATE TABLE audit_logs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  admin_id UUID REFERENCES admin_users NOT NULL,
  action TEXT NOT NULL,
  entity_type TEXT NOT NULL,
  entity_id UUID,
  details JSONB,
  ip_address TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);
```

### דוגמאות להרשאות מנהל

```json
{
  "roles": [
    {
      "name": "super_admin",
      "permissions": {
        "users": ["view", "create", "edit", "delete"],
        "courses": ["view", "create", "edit", "delete", "publish"],
        "forum": ["view", "create", "edit", "delete", "moderate"],
        "simulator": ["view", "create", "edit", "delete"],
        "system": ["view", "edit"],
        "reports": ["view", "create", "export"]
      }
    },
    {
      "name": "content_manager",
      "permissions": {
        "users": ["view"],
        "courses": ["view", "create", "edit", "publish"],
        "forum": ["view", "moderate"],
        "simulator": ["view", "create", "edit"],
        "system": ["view"],
        "reports": ["view"]
      }
    },
    {
      "name": "community_moderator",
      "permissions": {
        "users": ["view"],
        "courses": ["view"],
        "forum": ["view", "edit", "delete", "moderate"],
        "simulator": ["view"],
        "system": [],
        "reports": ["view"]
      }
    }
  ]
}
```
