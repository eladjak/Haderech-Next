# סימולטור התרגול - תיעוד

מסמך זה מתאר את פונקציונליות הסימולטור באפליקציית "הדרך", המאפשר למשתמשים לתרגל מיומנויות תקשורת ואינטראקציה בסביבה מבוקרת.

## סקירה כללית

הסימולטור הוא כלי אינטראקטיבי המאפשר למשתמשים לתרגל מיומנויות תקשורת ופתרון בעיות דרך תרחישים מציאותיים. הוא מספק סביבה בטוחה לתרגול, עם משוב מפורט וניתוח ביצועים, ומאפשר למשתמשים לשפר את יכולותיהם בקצב שלהם.

## מרכיבים עיקריים

### 1. בחירת תרחישים

ממשק לבחירת תרחישי תרגול:

- **קטלוג תרחישים** - מגוון תרחישים בקטגוריות שונות
- **סינון תרחישים** - סינון לפי קושי, קטגוריה, מיומנויות ועוד
- **תרחישים מותאמים אישית** - המלצות מותאמות אישית בהתאם להתקדמות המשתמש
- **תרחישים מובנים** - תרחישים שנבנו כחלק מתוכנית לימודים מובנית

### 2. ממשק הסימולציה

סביבת התרגול עצמה:

- **חלון צ'אט** - אינטראקציה עם הדמות הוירטואלית
- **מידע תרחיש** - הצגת הקונטקסט, היעדים, והנחיות לתרחיש
- **אפשרויות תגובה** - כלים לניסוח תגובות ומענה
- **עזרים ורמזים** - כלי עזר לסיוע בתרגול (לפי הצורך)

### 3. מנוע בינה מלאכותית

מערכת ה-AI מאחורי הסימולטור:

- **מודל שיחה חכם** - מבוסס על טכנולוגיית GPT לניהול דו-שיח טבעי
- **מנתח תגובות** - ניתוח והערכת תגובות המשתמש בזמן אמת
- **מנגנון תגובות דינמיות** - התאמת התגובות של הדמות הוירטואלית למהלך השיחה
- **מערכת למידה** - שיפור מתמיד של המודל בהתבסס על אינטראקציות

### 4. מערכת משוב והערכה

ניתוח ביצועים ומשוב למשתמש:

- **משוב מיידי** - תגובות והערות בזמן אמת
- **ניתוח מפורט** - הערכה מפורטת בסיום התרחיש
- **מדדי ביצוע** - ציונים במדדים שונים (אמפתיה, בהירות, יעילות וכו')
- **המלצות לשיפור** - הצעות מעשיות לשיפור ביצועים עתידיים

### 5. מעקב התקדמות

ניטור וניתוח התקדמות לאורך זמן:

- **סטטיסטיקות ביצועים** - מעקב אחר ביצועים לאורך זמן
- **זיהוי מגמות** - זיהוי נקודות חוזק וחולשה
- **השוואה היסטורית** - השוואת ביצועים נוכחיים לביצועים קודמים
- **יעדים ואתגרים** - הגדרת יעדים אישיים והתקדמות לקראתם

## ארכיטקטורה טכנית

### רכיבי לקוח (Client-Side)

- **ScenarioSelector** - רכיב לבחירת תרחישים
- **ChatSimulator** - רכיב הצ'אט המרכזי לניהול השיחה
- **ChatHeader** - כותרת הצ'אט עם מידע על התרחיש
- **MessageList** - רשימת ההודעות בשיחה
- **MessageItem** - רכיב הודעה בודדת
- **InputBox** - תיבת קלט למשתמש
- **FeedbackDisplay** - תצוגת משוב והערכה
- **ErrorDisplay** - תצוגת שגיאות ואירועים חריגים

### רכיבי שרת (Server-Side)

- **SimulatorService** - שירות ניהול הסימולציה
- **OpenAIService** - שירות תקשורת עם OpenAI API
- **FeedbackService** - שירות ניתוח והערכת ביצועים
- **ScenarioService** - שירות ניהול תרחישים ומידע
- **ProgressService** - שירות מעקב התקדמות והישגים

### מודל נתונים

טבלאות עיקריות בבסיס הנתונים:

- `simulator_scenarios` - תרחישי סימולציה
- `simulator_sessions` - מידע על מפגשי תרגול
- `simulator_messages` - הודעות במפגשי תרגול
- `simulator_feedback` - משוב והערכות ביצועים
- `simulator_results` - תוצאות סימולציות
- `simulator_user_stats` - סטטיסטיקות משתמש מצטברות

## תזרים עבודה

### התחלת תרגול

1. המשתמש בוחר תרחיש לתרגול מתוך הקטלוג
2. המערכת מציגה את פרטי התרחיש ויעדי הלמידה
3. המשתמש מאשר ומתחיל את התרגול
4. המערכת מציגה את הפתיחה של התרחיש ומחכה לתגובת המשתמש

### ניהול השיחה

1. המשתמש מקליד ושולח תגובה
2. המערכת מעבדת את התגובה ומנתחת אותה
3. המערכת מייצרת תגובה מתאימה מבוססת-AI
4. תגובת המערכת מוצגת למשתמש, והשיחה ממשיכה

### סיום וניתוח

1. המשתמש מסיים את התרחיש (או שהתרחיש מסתיים לפי הקריטריונים שהוגדרו)
2. המערכת מציגה ניתוח מפורט של הביצועים
3. המשתמש מקבל משוב מפורט וציונים במדדים שונים
4. המערכת מציעה המלצות לשיפור והמשך תרגול
5. התוצאות נשמרות לצורך מעקב התקדמות לאורך זמן

## תכונות מתקדמות

### 1. סימולציה מתקדמת

תכונות מתקדמות להעשרת חווית הסימולציה:

- **זיהוי כוונות** - הבנה מתקדמת של כוונות המשתמש
- **זיהוי רגשות** - זיהוי טון ורגש בטקסט המשתמש
- **תגובות מותאמות תרבות** - התאמת התגובות לרגישויות תרבותיות
- **התאמת קושי דינמית** - שינוי מורכבות התרחיש בהתאם לביצועי המשתמש

### 2. סימולציה רב-ערוצית

הרחבת אופני האינטראקציה:

- **תמיכה בקול** - אפשרות לתקשורת קולית
- **תמיכה בוידאו** - שילוב אווטארים ווידאו במקרים מתאימים
- **שילוב תמונות** - אפשרות להעלאת תמונות ותיעוד כחלק מהתרחיש
- **מולטימדיה** - שילוב תוכן מולטימדיה בתרחישים

### 3. ניתוח מתקדם

כלים מתקדמים לניתוח ביצועים:

- **דוחות מפורטים** - ניתוח מעמיק של דפוסי תקשורת
- **זיהוי חזקות וחולשות** - זיהוי אוטומטי של נקודות חוזק וחולשה
- **מסלולי שיפור** - המלצות מותאמות אישית למסלולי תרגול
- **ניתוח השוואתי** - השוואה לעמיתים ולנורמות מקצועיות

## סטטוס פיתוח

- [x] ממשק בסיסי לסימולציה
- [x] תמיכה בתרחישים בסיסיים
- [x] אינטגרציה עם OpenAI API
- [x] מערכת משוב בסיסית
- [ ] זיהוי רגשות ומודעות הקשרית
- [ ] תרחישים מורכבים ומסתעפים
- [ ] ניתוח ביצועים ברמה גבוהה
- [ ] תמיכה בקול וסימולציה רב-ערוצית

## התקנה ושימוש למפתחים

### קבצים רלוונטיים

- `src/components/simulator/` - רכיבי הסימולטור
- `src/app/simulator/` - דפי הסימולטור
- `src/lib/services/simulator.ts` - שירות הסימולטור
- `src/app/api/simulator/` - API endpoints של הסימולטור
- `src/constants/simulator.ts` - קבועים והגדרות של הסימולטור

### הוספת תרחיש חדש

1. הגדר את מבנה התרחיש ב-`src/types/simulator.ts`
2. הוסף את התרחיש ב-`src/constants/simulator.ts` או בבסיס הנתונים
3. עדכן את כללי המשוב ב-`src/lib/services/simulator.ts` במידת הצורך
4. בדוק את התרחיש עם מגוון תגובות אפשריות

### הוספת מדד הערכה חדש

1. הוסף את המדד החדש ב-`src/types/simulator.ts` בממשק `FeedbackMetrics`
2. הוסף פונקציית הערכה מתאימה ב-`src/lib/services/simulator.ts`
3. עדכן את הפרומפט לייצור משוב ב-`generateFinalFeedback`
4. הוסף את המדד החדש בתצוגת המשוב ב-`src/components/simulator/FeedbackDisplay.tsx`

## שאלות נפוצות למפתחים

### איך לייעל את השימוש ב-OpenAI API?

1. אופטימיזציה של פרומפטים לקבלת תוצאות ממוקדות
2. בחירת מודל מתאים לפי מורכבות המשימה
3. שימוש ב-caching לתגובות דומות
4. הגבלת אורך תשובות כשניתן

### איך להתמודד עם תקשורת בעברית?

1. וודא שהפרומפטים מוגדרים בעברית תקנית
2. השתמש במודל GPT-4 לתוצאות טובות יותר בעברית
3. הוסף הנחיות ספציפיות למודל להתמודדות עם ניואנסים של השפה
4. בדוק דוגמאות רבות לוודא עקביות בתשובות

## נספחים

### מודל נתונים מפורט

```sql
-- טבלת תרחישים
CREATE TABLE simulator_scenarios (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  title TEXT NOT NULL,
  description TEXT NOT NULL,
  category TEXT NOT NULL,
  difficulty TEXT NOT NULL,
  initial_message TEXT NOT NULL,
  context TEXT,
  objectives TEXT[] DEFAULT '{}',
  expected_outcomes TEXT[] DEFAULT '{}',
  learning_objectives TEXT[] DEFAULT '{}',
  success_criteria JSONB,
  max_turns INTEGER,
  time_limit INTEGER,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

-- טבלת מפגשי תרגול
CREATE TABLE simulator_sessions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES auth.users NOT NULL,
  scenario_id UUID REFERENCES simulator_scenarios NOT NULL,
  status TEXT NOT NULL,
  feedback JSONB,
  duration INTEGER,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  completed_at TIMESTAMP WITH TIME ZONE
);

-- טבלת הודעות
CREATE TABLE simulator_messages (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  session_id UUID REFERENCES simulator_sessions NOT NULL,
  role TEXT NOT NULL,
  content TEXT NOT NULL,
  feedback JSONB,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);
```

### דוגמה לבנייה מובנית של תרחיש

```typescript
// src/constants/scenarios/classroom-management.ts
import { SimulatorScenario } from "@/types/simulator";

export const ClassroomDisruptionScenario: SimulatorScenario = {
  id: "classroom-disruption-1",
  title: "התמודדות עם הפרעות בכיתה",
  description: "תרגול תגובה לתלמיד שמפריע למהלך השיעור",
  category: "classroom-management",
  difficulty: "intermediate",
  initial_message:
    "אתה מלמד שיעור מתמטיקה כאשר תלמיד מתחיל לדבר בקול רם עם חבריו לכיתה, מפריע למהלך השיעור. כיצד תגיב?",
  context: "אתה מלמד כיתה ז' עם 25 תלמידים. התלמיד המסוים הזה הפריע בעבר.",
  objectives: [
    "התמודדות עם ההפרעה מבלי להסלים את המצב",
    "שמירה על מיקוד הכיתה",
    "התייחסות לתלמיד בכבוד",
  ],
  expected_outcomes: [
    "התלמיד מפסיק את ההתנהגות המפריעה",
    "הכיתה חוזרת לשיעור",
    "התלמיד מרגיש שהקשיבו לו ולא העניש אותו",
  ],
  learning_objectives: [
    "פיתוח יכולת התמודדות עם הפרעות",
    "תקשורת יעילה בכיתה",
    "ניהול כיתה אפקטיבי",
  ],
  success_criteria: {
    minScore: 70,
    requiredSkills: ["תקשורת אפקטיבית", "פתרון בעיות", "אמפתיה"],
    minDuration: 120,
    maxDuration: 600,
  },
  max_turns: 5,
  time_limit: 600,
  created_at: new Date().toISOString(),
  updated_at: new Date().toISOString(),
};
```

### דוגמה לתגובת משוב

```json
{
  "score": 85,
  "metrics": {
    "empathy": 90,
    "clarity": 85,
    "effectiveness": 80,
    "appropriateness": 85,
    "professionalism": 90,
    "problem_solving": 80,
    "overall": 85
  },
  "strengths": [
    "יצירת קשר אישי עם התלמיד",
    "הבנת הסיבות להתנהגות המפריעה",
    "שמירה על כבוד התלמיד לאורך כל האינטראקציה"
  ],
  "improvements": [
    "הצבת גבולות ברורים יותר",
    "תקשורת יותר ישירה בנוגע לציפיות"
  ],
  "tips": [
    "נסה להשתמש בשאלות פתוחות לעודד רפלקציה",
    "שקול לקבוע פגישה אישית לאחר השיעור"
  ],
  "comments": "הראית אמפתיה משמעותית ויכולת להבין את נקודת המבט של התלמיד. התגובות שלך היו מכבדות ומקצועיות. לשיפור, כדאי להיות יותר ברור לגבי הציפיות והגבולות שלך.",
  "suggestions": [
    "תרגל הצבת גבולות תוך שמירה על קשר חיובי",
    "התנסה בתרחישים דומים עם רמת קושי גבוהה יותר"
  ]
}
```
