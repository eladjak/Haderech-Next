# תהליך Pre-Commit 🔍

## סקירה כללית

תהליך ה-pre-commit הוא חלק קריטי מתהליך הפיתוח שלנו, המיועד למנוע דחיפת קוד שעלול לגרום לכשלון בבנייה ב-Vercel. התהליך מבוצע באופן אוטומטי לפני כל commit באמצעות Husky.

## תהליך הבדיקה 🔄

התהליך כולל את הבדיקות הבאות:

1. **בדיקת טיפוסים (TypeScript)**

   ```bash
   pnpm type-check
   ```

   - בודק שגיאות טיפוסים
   - מוודא תאימות בין ממשקים
   - מזהה שגיאות קומפילציה פוטנציאליות

2. **בדיקת לינטינג (ESLint)**

   ```bash
   pnpm lint:strict
   ```

   - בודק סגנון קוד
   - מזהה בעיות פוטנציאליות
   - מוודא עמידה בסטנדרטים

3. **בדיקת פורמט (Prettier)**

   ```bash
   pnpm format:check
   ```

   - בודק עיצוב קוד אחיד
   - מוודא סגנון עקבי

4. **בדיקות יחידה (Vitest)**
   ```bash
   pnpm test
   ```
   - מריץ בדיקות יחידה
   - בודק פונקציונליות
   - מוודא כיסוי קוד

## תצורת Husky 🛠️

הגדרות ה-Husky נמצאות בקובץ `.husky/pre-commit`:

```bash
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

pnpm lint-staged
```

והגדרות ה-lint-staged בקובץ `.lintstagedrc.js`:

```javascript
module.exports = {
  "*.{js,jsx,ts,tsx}": ["pnpm lint:fix", "pnpm format", "vitest related --run"],
};
```

## טיפול בשגיאות 🚨

### שגיאות טיפוסים

1. בדוק את הודעות השגיאה ב-TypeScript
2. וודא שכל הטיפוסים מוגדרים נכון
3. תקן חוסר התאמה בין ממשקים

### שגיאות לינטינג

1. הרץ `pnpm lint:fix` לתיקון אוטומטי
2. בדוק את הכללים הספציפיים שנכשלו
3. עדכן את הקוד בהתאם לכללים

### שגיאות פורמט

1. הרץ `pnpm format` לתיקון אוטומטי
2. בדוק שינויים בלתי צפויים
3. וודא שהפורמט תואם את הסטנדרטים

### שגיאות בדיקות

1. בדוק את הבדיקות שנכשלו
2. וודא שהשינויים לא שברו פונקציונליות קיימת
3. עדכן בדיקות במידת הצורך

## תהליך עבודה מומלץ 💡

1. **לפני התחלת העבודה**

   - משוך את הגרסה העדכנית מ-main
   - וודא שכל הבדיקות עוברות

2. **במהלך הפיתוח**

   - בצע בדיקות מקומיות תכופות
   - תקן שגיאות מיד כשהן מתגלות
   - שמור על כיסוי בדיקות גבוה

3. **לפני commit**

   - הרץ `pnpm validate` לבדיקה מקיפה
   - וודא שאין שגיאות
   - תקן בעיות שמתגלות

4. **אחרי commit**
   - וודא שה-CI עובר בהצלחה
   - בדוק את ה-preview ב-Vercel
   - וודא שהאפליקציה עובדת כמצופה

## תחזוקה ועדכונים 🔄

1. **עדכון תלויות**

   - בדוק עדכוני חבילות באופן קבוע
   - וודא תאימות עם הגדרות הפרויקט
   - עדכן את הגדרות הבדיקות בהתאם

2. **עדכון כללים**

   - סקור את כללי ה-ESLint תקופתית
   - עדכן הגדרות Prettier לפי הצורך
   - הוסף בדיקות חדשות לפי הצורך

3. **ניטור ביצועים**
   - בדוק זמני ריצה של בדיקות
   - אופטימז בדיקות איטיות
   - שמור על איזון בין כיסוי למהירות

## פתרון בעיות נפוצות 🔧

1. **שגיאות בניה ב-Vercel**

   - בדוק את לוגי הבניה
   - וודא תאימות גרסאות
   - בדוק הגדרות סביבה

2. **בדיקות איטיות**

   - זהה בדיקות בעייתיות
   - שקול שימוש ב-mocking
   - אופטימז בדיקות כבדות

3. **התנגשויות טיפוסים**
   - בדוק הגדרות טיפוסים
   - וודא ייבוא נכון של טיפוסים
   - עדכן הגדרות לפי הצורך
